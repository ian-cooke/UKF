function dfdx = dfdx_wJ2(z_num, params)
%DFDX_WJ2 numerical evaluation of jacobian produced from dfdx_wJ2_sym
% param things
mue = params.mu;
J2 = params.J2;
R_E = params.R_E;

% from z_num
x = z_num(1); y = z_num(2); z = z_num(3);

% evaluate
dfdx = [                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0, 1, 0, 0;...
                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0, 0, 1, 0;...
                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0, 0, 0, 1;...
                                                                (3*mue*x^2)/(x^2 + y^2 + z^2)^(5/2) - mue/(x^2 + y^2 + z^2)^(3/2) + (3*J2*R_E^2*mue*z^2)/(x^2 + y^2 + z^2)^(7/2) + (3*J2*R_E^2*mue*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2)) - (30*J2*R_E^2*mue*x^2*z^2)/(x^2 + y^2 + z^2)^(9/2) - (15*J2*R_E^2*mue*x^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)),                                                                                                                                                                                                                    (3*mue*x*y)/(x^2 + y^2 + z^2)^(5/2) - (30*J2*R_E^2*mue*x*y*z^2)/(x^2 + y^2 + z^2)^(9/2) - (15*J2*R_E^2*mue*x*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)),                                                                                                                                          (3*mue*x*z)/(x^2 + y^2 + z^2)^(5/2) + (6*J2*R_E^2*mue*x*z)/(x^2 + y^2 + z^2)^(7/2) - (21*J2*R_E^2*mue*x*z^3)/(x^2 + y^2 + z^2)^(9/2) + (3*J2*R_E^2*mue*x*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)^(5/2)) - (15*J2*R_E^2*mue*x*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)), 0, 0, 0;...
                                                                                                                                                                                                                            (3*mue*x*y)/(x^2 + y^2 + z^2)^(5/2) - (30*J2*R_E^2*mue*x*y*z^2)/(x^2 + y^2 + z^2)^(9/2) - (15*J2*R_E^2*mue*x*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)),                                                        (3*mue*y^2)/(x^2 + y^2 + z^2)^(5/2) - mue/(x^2 + y^2 + z^2)^(3/2) + (3*J2*R_E^2*mue*z^2)/(x^2 + y^2 + z^2)^(7/2) + (3*J2*R_E^2*mue*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2)) - (30*J2*R_E^2*mue*y^2*z^2)/(x^2 + y^2 + z^2)^(9/2) - (15*J2*R_E^2*mue*y^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)),                                                                                                                                          (3*mue*y*z)/(x^2 + y^2 + z^2)^(5/2) + (6*J2*R_E^2*mue*y*z)/(x^2 + y^2 + z^2)^(7/2) - (21*J2*R_E^2*mue*y*z^3)/(x^2 + y^2 + z^2)^(9/2) + (3*J2*R_E^2*mue*y*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)^(5/2)) - (15*J2*R_E^2*mue*y*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)), 0, 0, 0;...
         (3*mue*x*z)/(x^2 + y^2 + z^2)^(5/2) + (J2*R_E^2*mue*((12*x*z)/(x^2 + y^2 + z^2)^2 - (24*x*z^3)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)^(3/2)) - (9*J2*R_E^2*mue*x*z^3)/(x^2 + y^2 + z^2)^(9/2) + (3*J2*R_E^2*mue*x*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)^(5/2)) - (15*J2*R_E^2*mue*x*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)), (3*mue*y*z)/(x^2 + y^2 + z^2)^(5/2) + (J2*R_E^2*mue*((12*y*z)/(x^2 + y^2 + z^2)^2 - (24*y*z^3)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)^(3/2)) - (9*J2*R_E^2*mue*y*z^3)/(x^2 + y^2 + z^2)^(9/2) + (3*J2*R_E^2*mue*y*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)^(5/2)) - (15*J2*R_E^2*mue*y*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)), (3*mue*z^2)/(x^2 + y^2 + z^2)^(5/2) - mue/(x^2 + y^2 + z^2)^(3/2) - (J2*R_E^2*mue*(6/(x^2 + y^2 + z^2) - (30*z^2)/(x^2 + y^2 + z^2)^2 + (24*z^4)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J2*R_E^2*mue*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2)) + (3*J2*R_E^2*mue*z*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(5/2) - (15*J2*R_E^2*mue*z^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(7/2)), 0, 0, 0];
 
end

